<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator Pro</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: auto;
        }

        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            min-height: 600px;
        }

        .main-calculator {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 255, 255, 0.1);
        }

        .theme-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .theme-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .theme-btn.active {
            background: linear-gradient(45deg, #00ffff, #0080ff);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .display-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        .display {
            background: transparent;
            border: none;
            color: #00ffff;
            font-size: 2.5rem;
            text-align: right;
            width: 100%;
            outline: none;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .expression {
            color: #888;
            font-size: 1rem;
            text-align: right;
            margin-bottom: 10px;
            min-height: 20px;
        }

        .keypad {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 12px;
        }

        .btn {
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.operator {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            border-color: #ff6b6b;
        }

        .btn.function {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            border-color: #4ecdc4;
        }

        .btn.number {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-color: #667eea;
        }

        .btn.equals {
            background: linear-gradient(45deg, #00ffff, #0080ff);
            grid-column: span 2;
            font-weight: bold;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
        }

        .btn.clear {
            background: linear-gradient(45deg, #ff4757, #ff3742);
            border-color: #ff4757;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .history-panel, .memory-panel, .constants-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.2);
        }

        .panel-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #00ffff;
            text-align: center;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .history-item {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .history-item:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: rgba(0, 255, 255, 0.3);
        }

        .memory-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .memory-btn {
            padding: 8px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .memory-btn:hover {
            background: rgba(0, 255, 255, 0.2);
        }

        .constants-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .constant-btn {
            padding: 8px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #ffa726, #ff9800);
            color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .constant-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 167, 38, 0.5);
        }

        .error {
            color: #ff4757;
            text-shadow: 0 0 10px rgba(255, 71, 87, 0.5);
        }

        @media (max-width: 768px) {
            .calculator-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .keypad {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .display {
                font-size: 2rem;
            }
        }

        .glow {
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
            }
            to {
                box-shadow: 0 0 30px rgba(0, 255, 255, 0.6);
            }
        }

        .voice-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .voice-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
        }

        .voice-btn.listening {
            animation: pulse 1s infinite;
            background: linear-gradient(45deg, #00ff00, #32cd32);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <div class="main-calculator">
            <div class="theme-selector">
                <button class="theme-btn active" onclick="setTheme('neon')">Neon</button>
                <button class="theme-btn" onclick="setTheme('dark')">Dark</button>
                <button class="theme-btn" onclick="setTheme('light')">Light</button>
            </div>

            <button class="voice-btn" onclick="toggleVoice()" title="Voice Input">ðŸŽ¤</button>

            <div class="display-container glow">
                <div class="expression" id="expression"></div>
                <input type="text" class="display" id="display" value="0" readonly>
            </div>

            <div class="keypad">
                <button class="btn clear" onclick="clearAll()">AC</button>
                <button class="btn clear" onclick="clearEntry()">CE</button>
                <button class="btn operator" onclick="appendOperator('(')">(</button>
                <button class="btn operator" onclick="appendOperator(')')">)</button>
                <button class="btn operator" onclick="appendOperator('/')" title="Divide">Ã·</button>
                <button class="btn function" onclick="appendFunction('sqrt(')" title="Square Root">âˆš</button>

                <button class="btn function" onclick="appendFunction('sin(')" title="Sine">sin</button>
                <button class="btn function" onclick="appendFunction('cos(')" title="Cosine">cos</button>
                <button class="btn function" onclick="appendFunction('tan(')" title="Tangent">tan</button>
                <button class="btn function" onclick="appendFunction('log(')" title="Log base 10">log</button>
                <button class="btn operator" onclick="appendOperator('*')" title="Multiply">Ã—</button>
                <button class="btn function" onclick="power(2)" title="Square">xÂ²</button>

                <button class="btn function" onclick="appendFunction('asin(')" title="Arcsine">asin</button>
                <button class="btn function" onclick="appendFunction('acos(')" title="Arccosine">acos</button>
                <button class="btn function" onclick="appendFunction('atan(')" title="Arctangent">atan</button>
                <button class="btn function" onclick="appendFunction('ln(')" title="Natural Log">ln</button>
                <button class="btn operator" onclick="appendOperator('-')" title="Subtract">-</button>
                <button class="btn function" onclick="power(3)" title="Cube">xÂ³</button>

                <button class="btn number" onclick="appendNumber('7')">7</button>
                <button class="btn number" onclick="appendNumber('8')">8</button>
                <button class="btn number" onclick="appendNumber('9')">9</button>
                <button class="btn function" onclick="factorial()" title="Factorial">n!</button>
                <button class="btn operator" onclick="appendOperator('+')" title="Add">+</button>
                <button class="btn function" onclick="power('x')" title="Power">x^y</button>

                <button class="btn number" onclick="appendNumber('4')">4</button>
                <button class="btn number" onclick="appendNumber('5')">5</button>
                <button class="btn number" onclick="appendNumber('6')">6</button>
                <button class="btn function" onclick="appendFunction('exp(')" title="Exponential">exp</button>
                <button class="btn function" onclick="reciprocal()" title="Reciprocal">1/x</button>
                <button class="btn function" onclick="percentage()" title="Percentage">%</button>

                <button class="btn number" onclick="appendNumber('1')">1</button>
                <button class="btn number" onclick="appendNumber('2')">2</button>
                <button class="btn number" onclick="appendNumber('3')">3</button>
                <button class="btn function" onclick="appendFunction('abs(')" title="Absolute Value">|x|</button>
                <button class="btn operator" onclick="backspace()" title="Backspace">âŒ«</button>
                <button class="btn function" onclick="negate()" title="Negate">Â±</button>

                <button class="btn number" onclick="appendNumber('0')">0</button>
                <button class="btn operator" onclick="appendOperator('.')">.</button>
                <button class="btn function" onclick="appendFunction('random()')" title="Random">Rnd</button>
                <button class="btn function" onclick="copyResult()" title="Copy Result">ðŸ“‹</button>
                <button class="btn equals" onclick="calculate()">=</button>
            </div>
        </div>

        <div class="sidebar">
            <div class="history-panel">
                <div class="panel-title">History</div>
                <div id="history"></div>
                <button class="memory-btn" onclick="clearHistory()" style="width: 100%; margin-top: 10px;">Clear History</button>
            </div>

            <div class="memory-panel">
                <div class="panel-title">Memory</div>
                <div class="memory-buttons">
                    <button class="memory-btn" onclick="memoryStore()">MS</button>
                    <button class="memory-btn" onclick="memoryRecall()">MR</button>
                    <button class="memory-btn" onclick="memoryAdd()">M+</button>
                    <button class="memory-btn" onclick="memorySubtract()">M-</button>
                    <button class="memory-btn" onclick="memoryClear()">MC</button>
                </div>
                <div id="memoryDisplay" style="text-align: center; margin-top: 10px; color: #00ffff;">Memory: 0</div>
            </div>

            <div class="constants-panel">
                <div class="panel-title">Constants</div>
                <div class="constants-grid">
                    <button class="constant-btn" onclick="insertConstant(Math.PI)" title="Pi">Ï€</button>
                    <button class="constant-btn" onclick="insertConstant(Math.E)" title="Euler's number">e</button>
                    <button class="constant-btn" onclick="insertConstant(1.618033988749)" title="Golden ratio">Ï†</button>
                    <button class="constant-btn" onclick="insertConstant(299792458)" title="Speed of light">c</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let display = document.getElementById('display');
        let expression = document.getElementById('expression');
        let currentInput = '0';
        let shouldResetDisplay = false;
        let memory = 0;
        let history = [];
        let isVoiceActive = false;

        // Mathematical functions
        const mathFunctions = {
            sin: Math.sin,
            cos: Math.cos,
            tan: Math.tan,
            asin: Math.asin,
            acos: Math.acos,
            atan: Math.atan,
            log: Math.log10,
            ln: Math.log,
            sqrt: Math.sqrt,
            exp: Math.exp,
            abs: Math.abs,
            random: Math.random
        };

        function updateDisplay() {
            display.value = currentInput;
        }

        function appendNumber(num) {
            if (shouldResetDisplay) {
                currentInput = '';
                shouldResetDisplay = false;
            }
            if (currentInput === '0') {
                currentInput = num;
            } else {
                currentInput += num;
            }
            updateDisplay();
        }

        function appendOperator(op) {
            if (shouldResetDisplay) {
                shouldResetDisplay = false;
            }
            currentInput += op;
            updateDisplay();
        }

        function appendFunction(func) {
            if (shouldResetDisplay) {
                currentInput = '';
                shouldResetDisplay = false;
            }
            if (currentInput === '0') {
                currentInput = func;
            } else {
                currentInput += func;
            }
            updateDisplay();
        }

        function clearAll() {
            currentInput = '0';
            expression.textContent = '';
            updateDisplay();
        }

        function clearEntry() {
            currentInput = '0';
            updateDisplay();
        }

        function backspace() {
            if (currentInput.length > 1) {
                currentInput = currentInput.slice(0, -1);
            } else {
                currentInput = '0';
            }
            updateDisplay();
        }

        function negate() {
            if (currentInput !== '0') {
                if (currentInput.startsWith('-')) {
                    currentInput = currentInput.substring(1);
                } else {
                    currentInput = '-' + currentInput;
                }
                updateDisplay();
            }
        }

        function power(exp) {
            if (exp === 'x') {
                currentInput += '^';
            } else {
                currentInput += '^' + exp;
            }
            updateDisplay();
        }

        function factorial() {
            try {
                let num = parseFloat(currentInput);
                if (num >= 0 && Number.isInteger(num)) {
                    let result = 1;
                    for (let i = 2; i <= num; i++) {
                        result *= i;
                    }
                    currentInput = result.toString();
                    updateDisplay();
                }
            } catch (e) {
                displayError();
            }
        }

        function reciprocal() {
            try {
                let num = parseFloat(currentInput);
                if (num !== 0) {
                    currentInput = (1 / num).toString();
                    updateDisplay();
                }
            } catch (e) {
                displayError();
            }
        }

        function percentage() {
            try {
                let num = parseFloat(currentInput);
                currentInput = (num / 100).toString();
                updateDisplay();
            } catch (e) {
                displayError();
            }
        }

        function calculate() {
            try {
                expression.textContent = currentInput + ' =';
                
                // Replace display symbols with JavaScript operators
                let expr = currentInput
                    .replace(/Ã—/g, '*')
                    .replace(/Ã·/g, '/')
                    .replace(/\^/g, '**');

                // Handle mathematical functions
                for (let func in mathFunctions) {
                    let regex = new RegExp(func + '\\(', 'g');
                    expr = expr.replace(regex, `mathFunctions.${func}(`);
                }

                let result = eval(expr);
                
                if (isNaN(result) || !isFinite(result)) {
                    throw new Error('Invalid calculation');
                }

                // Add to history
                history.unshift({
                    expression: currentInput,
                    result: result
                });
                
                if (history.length > 10) {
                    history.pop();
                }
                
                updateHistory();
                
                currentInput = result.toString();
                shouldResetDisplay = true;
                updateDisplay();
                
                // Voice output
                if ('speechSynthesis' in window) {
                    let utterance = new SpeechSynthesisUtterance(`The result is ${result}`);
                    utterance.rate = 0.8;
                    speechSynthesis.speak(utterance);
                }
                
            } catch (e) {
                displayError();
            }
        }

        function displayError() {
            currentInput = 'Error';
            display.classList.add('error');
            setTimeout(() => {
                display.classList.remove('error');
                currentInput = '0';
                updateDisplay();
            }, 2000);
            updateDisplay();
        }

        function insertConstant(value) {
            if (shouldResetDisplay || currentInput === '0') {
                currentInput = value.toString();
                shouldResetDisplay = false;
            } else {
                currentInput += value.toString();
            }
            updateDisplay();
        }

        // Memory functions
        function memoryStore() {
            try {
                memory = parseFloat(currentInput);
                updateMemoryDisplay();
            } catch (e) {
                // Handle error silently
            }
        }

        function memoryRecall() {
            currentInput = memory.toString();
            updateDisplay();
        }

        function memoryAdd() {
            try {
                memory += parseFloat(currentInput);
                updateMemoryDisplay();
            } catch (e) {
                // Handle error silently
            }
        }

        function memorySubtract() {
            try {
                memory -= parseFloat(currentInput);
                updateMemoryDisplay();
            } catch (e) {
                // Handle error silently
            }
        }

        function memoryClear() {
            memory = 0;
            updateMemoryDisplay();
        }

        function updateMemoryDisplay() {
            document.getElementById('memoryDisplay').textContent = `Memory: ${memory}`;
        }

        // History functions
        function updateHistory() {
            let historyDiv = document.getElementById('history');
            historyDiv.innerHTML = '';
            
            history.forEach((item, index) => {
                let historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div style="font-size: 0.8rem; color: #888;">${item.expression}</div>
                    <div style="color: #00ffff;">${item.result}</div>
                `;
                historyItem.onclick = () => {
                    currentInput = item.result.toString();
                    updateDisplay();
                };
                historyDiv.appendChild(historyItem);
            });
        }

        function clearHistory() {
            history = [];
            updateHistory();
        }

        // Voice functionality
        function toggleVoice() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Voice recognition not supported in this browser');
                return;
            }

            if (isVoiceActive) {
                stopVoiceRecognition();
            } else {
                startVoiceRecognition();
            }
        }

        function startVoiceRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onstart = () => {
                isVoiceActive = true;
                document.querySelector('.voice-btn').classList.add('listening');
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase();
                processVoiceInput(transcript);
            };

            recognition.onerror = () => {
                stopVoiceRecognition();
            };

            recognition.onend = () => {
                stopVoiceRecognition();
            };

            recognition.start();
        }

        function stopVoiceRecognition() {
            isVoiceActive = false;
            document.querySelector('.voice-btn').classList.remove('listening');
        }

        function processVoiceInput(transcript) {
            // Convert spoken words to mathematical expressions
            let expression = transcript
                .replace(/plus/g, '+')
                .replace(/minus/g, '-')
                .replace(/times/g, '*')
                .replace(/multiplied by/g, '*')
                .replace(/divided by/g, '/')
                .replace(/equals/g, '=')
                .replace(/square root of/g, 'sqrt(')
                .replace(/sine of/g, 'sin(')
                .replace(/cosine of/g, 'cos(')
                .replace(/tangent of/g, 'tan(')
                .replace(/pi/g, Math.PI.toString())
                .replace(/e/g, Math.E.toString())
                .replace(/\s+/g, '');

            currentInput = expression;
            updateDisplay();

            if (transcript.includes('equals') || transcript.includes('calculate')) {
                calculate();
            }
        }

        // Copy result to clipboard
        function copyResult() {
            navigator.clipboard.writeText(currentInput).then(() => {
                // Visual feedback
                let btn = event.target;
                let originalText = btn.textContent;
                btn.textContent = 'âœ“';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 1000);
            });
        }

        // Theme switching
        function setTheme(theme) {
            // Remove active class from all theme buttons
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
            // Add active class to clicked button
            event.target.classList.add('active');
            
            const body = document.body;
            body.className = theme + '-theme';
            
            // Apply theme-specific styles
            if (theme === 'light') {
                body.style.background = 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)';
                body.style.color = '#333';
            } else if (theme === 'dark') {
                body.style.background = 'linear-gradient(135deg, #2c3e50 0%, #34495e 100%)';
                body.style.color = '#ecf0f1';
            } else {
                body.style.background = 'linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%)';
                body.style.color = '#fff';
            }
        }

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            e.preventDefault();
            
            if (e.key >= '0' && e.key <= '9') {
                appendNumber(e.key);
            } else if (e.key === '.') {
                appendOperator('.');
            } else if (e.key === '+') {
                appendOperator('+');
            } else if (e.key === '-') {
                appendOperator('-');
            } else if (e.key === '*') {
                appendOperator('*');
            } else if (e.key === '/') {
                appendOperator('/');
            } else if (e.key === 'Enter' || e.key === '=') {
                calculate();
            } else if (e.key === 'Escape') {
                clearAll();
            } else if (e.key === 'Backspace') {
                backspace();
            } else if (e.key === '(' || e.key === ')') {
                appendOperator(e.key);
            }
        });

        // Initialize
        updateDisplay();
        updateMemoryDisplay();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'987e244437735500',t:'MTc1OTM0NDU4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>